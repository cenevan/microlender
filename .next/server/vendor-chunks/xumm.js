"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/xumm";
exports.ids = ["vendor-chunks/xumm"];
exports.modules = {

/***/ "(ssr)/./node_modules/xumm/dist/index.js":
/*!*****************************************!*\
  !*** ./node_modules/xumm/dist/index.js ***!
  \*****************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.Xumm = void 0;\nconst xumm_oauth2_pkce_1 = __webpack_require__(/*! xumm-oauth2-pkce */ \"(ssr)/./node_modules/xumm-oauth2-pkce/dist/index.js\");\nconst events_1 = __webpack_require__(/*! events */ \"events\");\n/**\n * Development?\n *   npm run watch (tsc in watch mode)\n *   npm run browserify-watch (watch, browserify tsc output)\n *   npm run serve (webserver, :3001)\n *   npm run dev (watch, nodemon dist/samples/index.js)\n *   ngrok start dev (local :3001 to https:// dev URL)\n *     > https://.../sample/\n */\n/**\n * TODO: Test:\n *    - Vue\n *    - Vite, SSR\n *    - React\n *    - Remix\n *    - ...\n */\n/**\n * Scenarios:\n *   - xApp: apikey:        » Go ahead\n *   - xApp: apikey+secret:             » ERROR\n *   - xApp: jwt:           » Go ahead\n * »»» Load SDKJWT + XAPP (UI INTERACTION)\n *\n *   - Browser: apikey      » PKCE\n *   - Browser: api+secret              » ERROR\n *   - Browser: jwt:        » Go ahead\n * »»» Load SDKJWT\n *\n *   - CLI: apikey                      » ERROR\n *   - CLI: jwt             » Go ahead\n *   - CLI: apikey+secret   » Go ahead\n * »»» Load SDK\n */\nvar Runtimes;\n(function (Runtimes) {\n    Runtimes[\"cli\"] = \"cli\";\n    Runtimes[\"browser\"] = \"browser\";\n    Runtimes[\"xapp\"] = \"xapp\";\n})(Runtimes || (Runtimes = {}));\nconst _runtime = {\n    cli: false,\n    browser: false,\n    xapp: false,\n};\nconst uuidv4re = new RegExp(\"^[0-9(a-f|A-F)]{8}-[0-9(a-f|A-F)]{4}-4[0-9(a-f|A-F)]{3}-[89ab][0-9(a-f|A-F)]{3}-[0-9(a-f|A-F)]{12}$\");\nconst _classes = {};\nconst _env = typeof process === \"object\" && process ? (process === null || process === void 0 ? void 0 : process.env) || {} : {};\nObject.assign(_runtime, {\n    cli: Object.keys(_env).indexOf(\"NODE\") > -1 ||\n        Object.keys(_env).indexOf(\"SHELL\") > -1 ||\n        Object.keys(_env).indexOf(\"TERM\") > -1 ||\n        Object.keys(_env).indexOf(\"PATH\") > -1,\n});\nObject.assign(_runtime, {\n    browser: (typeof process === \"object\" && process && (process === null || process === void 0 ? void 0 : false)) ||\n        (typeof document === \"object\" &&\n            document &&\n            (document === null || document === void 0 ? void 0 : document.location)),\n});\nObject.assign(_runtime, {\n    xapp: _runtime.browser && !!navigator.userAgent.match(/xumm\\/xapp/i),\n});\nconst runtime = Object.keys(_runtime).filter((r) => _runtime[r]);\nconst readyPromises = [];\n/**\n * Wrap a function into an awaiter, till the entire object is ready\n */\nconst Asyncify = (ReturnValue) => __awaiter(void 0, void 0, void 0, function* () {\n    yield Promise.all(readyPromises);\n    return yield ReturnValue();\n});\n/**\n * Take an entire constructed class & wrap all responses\n * in a promise (Asyncify) that waits for this entire class\n * to be ready.\n */\nconst Proxify = (ObjectToProxy) => {\n    return new Proxy(ObjectToProxy, {\n        get(obj, prop) {\n            if ([\"on\", \"off\"].indexOf(String(prop)) < 0 && // Events\n                (typeof obj[prop] === \"function\" ||\n                    obj.constructor.name === \"Promise\")) {\n                return function () {\n                    if (obj.constructor.name === \"Promise\") {\n                        return obj.then((res) => Asyncify(() => {\n                            return res[prop](...arguments);\n                        }));\n                    }\n                    return Asyncify(() => {\n                        return obj[prop](...arguments);\n                    });\n                };\n            }\n            return obj[prop];\n        },\n    });\n};\nconst _initialized = {\n    XummSdk: false,\n    XummSdkJwt: false,\n    XummPkce: false,\n    xApp: false,\n};\nlet _ott;\nlet _jwt = \"\";\nlet _jwtData = {};\nlet _me = {};\nlet instance = 0;\nclass UnifiedUserData {\n    constructor() {\n        this.account = Asyncify(() => { var _a, _b, _c; return (_b = (_a = _jwtData === null || _jwtData === void 0 ? void 0 : _jwtData.sub) !== null && _a !== void 0 ? _a : _me === null || _me === void 0 ? void 0 : _me.sub) !== null && _b !== void 0 ? _b : (_c = _ott === null || _ott === void 0 ? void 0 : _ott.account_info) === null || _c === void 0 ? void 0 : _c.account; });\n        this.picture = Asyncify(() => {\n            var _a, _b, _c, _d, _e, _f, _g;\n            return (_a = _me === null || _me === void 0 ? void 0 : _me.picture) !== null && _a !== void 0 ? _a : (((_c = (_b = _jwtData === null || _jwtData === void 0 ? void 0 : _jwtData.sub) !== null && _b !== void 0 ? _b : _me === null || _me === void 0 ? void 0 : _me.sub) !== null && _c !== void 0 ? _c : (_d = _ott === null || _ott === void 0 ? void 0 : _ott.account_info) === null || _d === void 0 ? void 0 : _d.account)\n                ? `https://xumm.app/avatar/${(_f = (_e = _jwtData === null || _jwtData === void 0 ? void 0 : _jwtData.sub) !== null && _e !== void 0 ? _e : _me === null || _me === void 0 ? void 0 : _me.sub) !== null && _f !== void 0 ? _f : (_g = _ott === null || _ott === void 0 ? void 0 : _ott.account_info) === null || _g === void 0 ? void 0 : _g.account}.png`\n                : undefined);\n        });\n        this.name = Asyncify(() => { var _a, _b; return (_a = _me === null || _me === void 0 ? void 0 : _me.name) !== null && _a !== void 0 ? _a : (_b = _ott === null || _ott === void 0 ? void 0 : _ott.account_info) === null || _b === void 0 ? void 0 : _b.name; });\n        this.domain = Asyncify(() => { var _a, _b; return (_a = _me === null || _me === void 0 ? void 0 : _me.domain) !== null && _a !== void 0 ? _a : (_b = _ott === null || _ott === void 0 ? void 0 : _ott.account_info) === null || _b === void 0 ? void 0 : _b.domain; });\n        this.source = Asyncify(() => { var _a, _b; return (_a = _me === null || _me === void 0 ? void 0 : _me.source) !== null && _a !== void 0 ? _a : (_b = _ott === null || _ott === void 0 ? void 0 : _ott.account_info) === null || _b === void 0 ? void 0 : _b.source; });\n        this.networkType = Asyncify(() => {\n            var _a, _b;\n            return (_b = (_a = _me === null || _me === void 0 ? void 0 : _me.networkType) !== null && _a !== void 0 ? _a : _jwtData.network_type) !== null && _b !== void 0 ? _b : _ott === null || _ott === void 0 ? void 0 : _ott.nodetype;\n        });\n        this.networkEndpoint = Asyncify(() => {\n            var _a, _b;\n            return (_b = (_a = _me === null || _me === void 0 ? void 0 : _me.networkEndpoint) !== null && _a !== void 0 ? _a : _jwtData.network_ndpoint) !== null && _b !== void 0 ? _b : _ott === null || _ott === void 0 ? void 0 : _ott.nodewss;\n        });\n        this.blocked = Asyncify(() => { var _a, _b; return (_a = _me === null || _me === void 0 ? void 0 : _me.blocked) !== null && _a !== void 0 ? _a : (_b = _ott === null || _ott === void 0 ? void 0 : _ott.account_info) === null || _b === void 0 ? void 0 : _b.blocked; });\n        this.kycApproved = Asyncify(() => { var _a, _b; return (_a = _me === null || _me === void 0 ? void 0 : _me.kycApproved) !== null && _a !== void 0 ? _a : (_b = _ott === null || _ott === void 0 ? void 0 : _ott.account_info) === null || _b === void 0 ? void 0 : _b.kycApproved; });\n        this.proSubscription = Asyncify(() => { var _a, _b; return (_a = _me === null || _me === void 0 ? void 0 : _me.proSubscription) !== null && _a !== void 0 ? _a : (_b = _ott === null || _ott === void 0 ? void 0 : _ott.account_info) === null || _b === void 0 ? void 0 : _b.proSubscription; });\n    }\n}\n/**\n * This is where the magic happens\n */\nclass Xumm extends events_1.EventEmitter {\n    constructor(apiKeyOrJwt, apiSecretOrOtt) {\n        var _a, _b, _c, _d;\n        super();\n        this.instance = \"0\";\n        this.jwtCredential = false;\n        this.runtime = _runtime;\n        instance++;\n        this.instance = String(instance);\n        if (typeof (console === null || console === void 0 ? void 0 : console.log) !== \"undefined\") {\n            console.log(\"Constructed Xumm\", { runtime });\n        }\n        let jwtExpired = false;\n        if (typeof apiKeyOrJwt === \"string\" &&\n            apiKeyOrJwt.split(\".\").length === 3) {\n            let _testJwtData;\n            try {\n                // Check validity\n                _testJwtData = JSON.parse(atob((_a = apiKeyOrJwt.split(\".\")) === null || _a === void 0 ? void 0 : _a[1]));\n            }\n            catch (e) {\n                // e\n                // Parse error\n            }\n            if (Date.now() >= _testJwtData.exp * 1000) {\n                jwtExpired = true;\n                const appId = (_d = (_c = (_b = _testJwtData === null || _testJwtData === void 0 ? void 0 : _testJwtData.app_uuidv4) !== null && _b !== void 0 ? _b : _testJwtData === null || _testJwtData === void 0 ? void 0 : _testJwtData.client_id) !== null && _c !== void 0 ? _c : _testJwtData === null || _testJwtData === void 0 ? void 0 : _testJwtData.aud) !== null && _d !== void 0 ? _d : '';\n                apiKeyOrJwt = appId;\n                console.log('JWT expired, falling back to API KEY: ' + appId);\n                if (_runtime.cli || _runtime.xapp) {\n                    const error = new Error('JWT Expired, cannot fall back to API credential: in CLI/xApp environment');\n                    this.emit('error', error);\n                    throw error;\n                }\n            }\n            if (!jwtExpired) {\n                this.jwtCredential = true;\n                _jwt = apiKeyOrJwt;\n            }\n        }\n        /**\n         * Handlers (setup)\n         */\n        const handleXappEvents = () => __awaiter(this, void 0, void 0, function* () {\n            // Always attach event listeners\n            // So no:  && !_initialized.xApp\n            if (_classes === null || _classes === void 0 ? void 0 : _classes.xApp) {\n                _initialized.xApp = true;\n                _classes.xApp.on(\"qr\", (data) => {\n                    this.emit(\"qr\", data, this.instance);\n                });\n                _classes.xApp.on(\"payload\", (data) => {\n                    this.emit(\"payload\", data, this.instance);\n                });\n                _classes.xApp.on(\"destination\", (data) => {\n                    this.emit(\"destination\", data, this.instance);\n                });\n            }\n        });\n        const handlePkceEvents = () => __awaiter(this, void 0, void 0, function* () {\n            // Always attach event listeners\n            // So no:  && !_initialized.XummPkce\n            if (_classes === null || _classes === void 0 ? void 0 : _classes.XummPkce) {\n                _initialized.XummPkce = true;\n                _classes.XummPkce.on(\"retrieved\", () => {\n                    this.emit(\"retrieved\");\n                });\n                _classes.XummPkce.on(\"success\", () => {\n                    this.emit(\"success\");\n                });\n                _classes.XummPkce.on(\"error\", (data) => {\n                    this.emit(\"error\", data);\n                });\n            }\n        });\n        /**\n         * Xumm SDK\n         */\n        const handleOttJwt = () => __awaiter(this, void 0, void 0, function* () {\n            var _e;\n            if ((_classes === null || _classes === void 0 ? void 0 : _classes.XummSdkJwt) && !_initialized.XummSdkJwt) {\n                _initialized.XummSdkJwt = true;\n                const doNotFetchJwtOtt = this.jwtCredential || _jwt !== \"\";\n                if (!doNotFetchJwtOtt) {\n                    readyPromises.push(_classes.XummSdkJwt.getOttData());\n                    readyPromises.push(_classes.XummSdkJwt.getJwt());\n                }\n                const ott = !doNotFetchJwtOtt\n                    ? yield _classes.XummSdkJwt.getOttData()\n                    : null;\n                const jwt = !doNotFetchJwtOtt\n                    ? yield _classes.XummSdkJwt.getJwt()\n                    : _jwt;\n                if (ott) {\n                    _ott = ott;\n                    // TODO: DISABLE\n                    // console.log(\"xapp ottdata\", _ott);\n                }\n                if (jwt) {\n                    _jwt = jwt;\n                    try {\n                        _jwtData = JSON.parse(atob((_e = _jwt.split(\".\")) === null || _e === void 0 ? void 0 : _e[1]));\n                        // console.log(\"pkce/xapp jwtdata\", _jwtData);\n                    }\n                    catch (e) {\n                        if (typeof (console === null || console === void 0 ? void 0 : console.log) !== \"undefined\") {\n                            console.log(\"Error decoding JWT\", (e === null || e === void 0 ? void 0 : e.message) || \"\");\n                        }\n                    }\n                }\n                if (typeof (console === null || console === void 0 ? void 0 : console.log) !== \"undefined\") {\n                    // console.log({ ott, jwt });\n                }\n            }\n        });\n        const initOttJwtRuntime = () => {\n            if (!(_classes === null || _classes === void 0 ? void 0 : _classes.XummSdkJwt)) {\n                Object.assign(_classes, {\n                    XummSdkJwt: new ((__webpack_require__(/*! xumm-sdk */ \"(ssr)/./node_modules/xumm-sdk/dist/src/index.js\").XummSdkJwt))(apiKeyOrJwt),\n                });\n                readyPromises.push(handleOttJwt());\n            }\n        };\n        if (_runtime.xapp) {\n            /**\n             * xApp\n             */\n            if (typeof apiKeyOrJwt !== \"string\" ||\n                !(uuidv4re.test(apiKeyOrJwt) || this.jwtCredential)) {\n                throw new Error(\"Running in xApp, constructor requires first param. to be Xumm API Key or JWT\");\n            }\n            if (!(_classes === null || _classes === void 0 ? void 0 : _classes.xApp)) {\n                Object.assign(_classes, {\n                    xApp: new ((__webpack_require__(/*! xumm-xapp-sdk */ \"(ssr)/./node_modules/xumm-xapp-sdk/dist/index.js\").xApp))(),\n                });\n            }\n            readyPromises.push(handleXappEvents());\n            initOttJwtRuntime();\n        }\n        else if (_runtime.browser) {\n            /**\n             * Browser (JWT, PKCE?)\n             */\n            if (typeof apiKeyOrJwt !== \"string\" ||\n                !(uuidv4re.test(apiKeyOrJwt) || this.jwtCredential)) {\n                throw new Error(\"Running in browser, constructor requires first param. to be Xumm API Key or JWT\");\n            }\n            if (!(_classes === null || _classes === void 0 ? void 0 : _classes.XummPkce)) {\n                Object.assign(_classes, {\n                    XummPkce: new xumm_oauth2_pkce_1.XummPkce(apiKeyOrJwt, {\n                        implicit: true,\n                    }),\n                });\n                if (_classes.XummPkce) {\n                    if (this.jwtCredential) {\n                        initOttJwtRuntime();\n                    }\n                    else {\n                        setImmediate(() => this.emit('retrieving'));\n                        const handlePkceState = (resolve) => {\n                            var _a, _b;\n                            (_b = (_a = _classes.XummPkce) === null || _a === void 0 ? void 0 : _a.state()) === null || _b === void 0 ? void 0 : _b.then((state) => {\n                                // state: jwt, me, sdk\n                                if ((state === null || state === void 0 ? void 0 : state.sdk) && !(_classes === null || _classes === void 0 ? void 0 : _classes.XummSdkJwt)) {\n                                    Object.assign(_classes, { XummSdkJwt: state.sdk });\n                                    Object.assign(_me, Object.assign({}, ((state === null || state === void 0 ? void 0 : state.me) || {})));\n                                }\n                                if ((state === null || state === void 0 ? void 0 : state.jwt) && _jwt === \"\") {\n                                    _jwt = state.jwt;\n                                    handleOttJwt();\n                                }\n                                resolve(state);\n                            });\n                        };\n                        readyPromises.push(handlePkceEvents());\n                        readyPromises.push(new Promise((resolve) => {\n                            var _a, _b;\n                            (_a = _classes.XummPkce) === null || _a === void 0 ? void 0 : _a.on(\"retrieved\", () => {\n                                handlePkceState(resolve);\n                            });\n                            (_b = _classes.XummPkce) === null || _b === void 0 ? void 0 : _b.on(\"success\", () => {\n                                handlePkceState(resolve);\n                            });\n                        }));\n                    }\n                }\n            }\n        }\n        else if (_runtime.cli) {\n            /**\n             * CLI, Node / ...\n             */\n            if (typeof apiKeyOrJwt !== \"string\") {\n                throw new Error(\"Running CLI, constructor needs first param. to be Xumm API Key / raw JWT\");\n            }\n            else {\n                if (uuidv4re.test(apiKeyOrJwt)) {\n                    // API Key\n                    if (typeof apiSecretOrOtt !== \"string\" ||\n                        !uuidv4re.test(apiSecretOrOtt)) {\n                        throw new Error(\"Running CLI, constructor first param. is API Key, but second param. isn't a valid API Secret\");\n                    }\n                }\n                if (!uuidv4re.test(apiKeyOrJwt) &&\n                    apiKeyOrJwt.split(\".\").length !== 3) {\n                    throw new Error(\"Running CLI, constructor first param. not a valid JWT, nor a valid API Key\");\n                }\n                // All fine\n                if (!(_classes === null || _classes === void 0 ? void 0 : _classes.XummSdk)) {\n                    if (this.jwtCredential) {\n                        initOttJwtRuntime();\n                    }\n                    else {\n                        Object.assign(_classes, {\n                            XummSdk: new ((__webpack_require__(/*! xumm-sdk */ \"(ssr)/./node_modules/xumm-sdk/dist/src/index.js\").XummSdk))(apiKeyOrJwt, apiSecretOrOtt),\n                        });\n                    }\n                }\n            }\n        }\n        /**\n         * Bootstrap class properties\n         */\n        this.user = new UnifiedUserData();\n        this.environment = {\n            jwt: Asyncify(() => _jwtData),\n            ott: Asyncify(() => _ott),\n            openid: Asyncify(() => _me),\n            bearer: Asyncify(() => _jwt),\n            retrieving: new Promise(resolve => this.on('retrieving', () => resolve())),\n            ready: new Promise(resolve => this.on('ready', () => resolve())),\n        };\n        /**\n         * Xumm SDK mapped\n         */\n        this.helpers = Proxify(Asyncify(() => (_classes.XummSdk || _classes.XummSdkJwt)));\n        this.push = Proxify(Asyncify(() => (_classes.XummSdk || _classes.XummSdkJwt)\n            .Push));\n        this.payload = Proxify(Asyncify(() => (_classes.XummSdk || _classes.XummSdkJwt)\n            .payload));\n        this.userstore = Proxify(Asyncify(() => (_classes.XummSdk || _classes.XummSdkJwt)\n            .jwtUserdata));\n        this.backendstore = Proxify(Asyncify(() => (_classes.XummSdk || _classes.XummSdkJwt)\n            .storage));\n        /**\n         * Xumm xApp SDK: UI lib.\n         */\n        const xapp = _classes === null || _classes === void 0 ? void 0 : _classes.xApp;\n        if (xapp)\n            this.xapp = xapp;\n        setImmediate(() => {\n            Promise.all(readyPromises).then(() => this.emit('ready'));\n        });\n    }\n    /**\n     * PKCE\n     */\n    authorize() {\n        var _a;\n        return __awaiter(this, void 0, void 0, function* () {\n            // console.log(\"Authorize\");\n            return (_a = _classes === null || _classes === void 0 ? void 0 : _classes.XummPkce) === null || _a === void 0 ? void 0 : _a.authorize();\n        });\n    }\n    logout() {\n        var _a;\n        return __awaiter(this, void 0, void 0, function* () {\n            Object.assign(_classes, { XummSdkJwt: undefined });\n            this.emit(\"logout\");\n            return (_a = _classes === null || _classes === void 0 ? void 0 : _classes.XummPkce) === null || _a === void 0 ? void 0 : _a.logout();\n        });\n    }\n    /**\n     * SDK\n     */\n    ping() {\n        var _a;\n        return __awaiter(this, void 0, void 0, function* () {\n            // TODO: What if not JWT but regular?\n            yield Promise.all(readyPromises);\n            return (_a = ((_classes === null || _classes === void 0 ? void 0 : _classes.XummSdkJwt) || (_classes === null || _classes === void 0 ? void 0 : _classes.XummSdk))) === null || _a === void 0 ? void 0 : _a.ping();\n        });\n    }\n}\nexports.Xumm = Xumm;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMveHVtbS9kaXN0L2luZGV4LmpzIiwibWFwcGluZ3MiOiJBQUFhO0FBQ2I7QUFDQSw0QkFBNEIsK0RBQStELGlCQUFpQjtBQUM1RztBQUNBLG9DQUFvQyxNQUFNLCtCQUErQixZQUFZO0FBQ3JGLG1DQUFtQyxNQUFNLG1DQUFtQyxZQUFZO0FBQ3hGLGdDQUFnQztBQUNoQztBQUNBLEtBQUs7QUFDTDtBQUNBLDhDQUE2QyxFQUFFLGFBQWEsRUFBQztBQUM3RCxZQUFZO0FBQ1osMkJBQTJCLG1CQUFPLENBQUMsNkVBQWtCO0FBQ3JELGlCQUFpQixtQkFBTyxDQUFDLHNCQUFRO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsNEJBQTRCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2Q0FBNkMsRUFBRSxnQkFBZ0IsRUFBRSxpQkFBaUIsRUFBRSxzQkFBc0IsRUFBRSxnQkFBZ0IsR0FBRztBQUMvSDtBQUNBLDRIQUE0SDtBQUM1SDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0EsMkdBQTJHLEtBQWU7QUFDMUg7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FB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QTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0NBQXNDLHVCQUF1QjtBQUM3RDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxZQUFZIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbWljcm9sZW5kZXIvLi9ub2RlX21vZHVsZXMveHVtbS9kaXN0L2luZGV4LmpzP2YzYWEiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG52YXIgX19hd2FpdGVyID0gKHRoaXMgJiYgdGhpcy5fX2F3YWl0ZXIpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcbiAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH1cbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBhZG9wdChyZXN1bHQudmFsdWUpLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xuICAgIH0pO1xufTtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcbmV4cG9ydHMuWHVtbSA9IHZvaWQgMDtcbmNvbnN0IHh1bW1fb2F1dGgyX3BrY2VfMSA9IHJlcXVpcmUoXCJ4dW1tLW9hdXRoMi1wa2NlXCIpO1xuY29uc3QgZXZlbnRzXzEgPSByZXF1aXJlKFwiZXZlbnRzXCIpO1xuLyoqXG4gKiBEZXZlbG9wbWVudD9cbiAqICAgbnBtIHJ1biB3YXRjaCAodHNjIGluIHdhdGNoIG1vZGUpXG4gKiAgIG5wbSBydW4gYnJvd3NlcmlmeS13YXRjaCAod2F0Y2gsIGJyb3dzZXJpZnkgdHNjIG91dHB1dClcbiAqICAgbnBtIHJ1biBzZXJ2ZSAod2Vic2VydmVyLCA6MzAwMSlcbiAqICAgbnBtIHJ1biBkZXYgKHdhdGNoLCBub2RlbW9uIGRpc3Qvc2FtcGxlcy9pbmRleC5qcylcbiAqICAgbmdyb2sgc3RhcnQgZGV2IChsb2NhbCA6MzAwMSB0byBodHRwczovLyBkZXYgVVJMKVxuICogICAgID4gaHR0cHM6Ly8uLi4vc2FtcGxlL1xuICovXG4vKipcbiAqIFRPRE86IFRlc3Q6XG4gKiAgICAtIFZ1ZVxuICogICAgLSBWaXRlLCBTU1JcbiAqICAgIC0gUmVhY3RcbiAqICAgIC0gUmVtaXhcbiAqICAgIC0gLi4uXG4gKi9cbi8qKlxuICogU2NlbmFyaW9zOlxuICogICAtIHhBcHA6IGFwaWtleTogICAgICAgIMK7IEdvIGFoZWFkXG4gKiAgIC0geEFwcDogYXBpa2V5K3NlY3JldDogICAgICAgICAgICAgwrsgRVJST1JcbiAqICAgLSB4QXBwOiBqd3Q6ICAgICAgICAgICDCuyBHbyBhaGVhZFxuICogwrvCu8K7IExvYWQgU0RLSldUICsgWEFQUCAoVUkgSU5URVJBQ1RJT04pXG4gKlxuICogICAtIEJyb3dzZXI6IGFwaWtleSAgICAgIMK7IFBLQ0VcbiAqICAgLSBCcm93c2VyOiBhcGkrc2VjcmV0ICAgICAgICAgICAgICDCu8KgRVJST1JcbiAqICAgLSBCcm93c2VyOiBqd3Q6ICAgICAgICDCuyBHbyBhaGVhZFxuICogwrvCu8K7IExvYWQgU0RLSldUXG4gKlxuICogICAtIENMSTogYXBpa2V5ICAgICAgICAgICAgICAgICAgICAgIMK7IEVSUk9SXG4gKiAgIC0gQ0xJOiBqd3QgICAgICAgICAgICAgwrvCoEdvIGFoZWFkXG4gKiAgIC0gQ0xJOiBhcGlrZXkrc2VjcmV0ICAgwrsgR28gYWhlYWRcbiAqIMK7wrvCuyBMb2FkIFNES1xuICovXG52YXIgUnVudGltZXM7XG4oZnVuY3Rpb24gKFJ1bnRpbWVzKSB7XG4gICAgUnVudGltZXNbXCJjbGlcIl0gPSBcImNsaVwiO1xuICAgIFJ1bnRpbWVzW1wiYnJvd3NlclwiXSA9IFwiYnJvd3NlclwiO1xuICAgIFJ1bnRpbWVzW1wieGFwcFwiXSA9IFwieGFwcFwiO1xufSkoUnVudGltZXMgfHwgKFJ1bnRpbWVzID0ge30pKTtcbmNvbnN0IF9ydW50aW1lID0ge1xuICAgIGNsaTogZmFsc2UsXG4gICAgYnJvd3NlcjogZmFsc2UsXG4gICAgeGFwcDogZmFsc2UsXG59O1xuY29uc3QgdXVpZHY0cmUgPSBuZXcgUmVnRXhwKFwiXlswLTkoYS1mfEEtRildezh9LVswLTkoYS1mfEEtRildezR9LTRbMC05KGEtZnxBLUYpXXszfS1bODlhYl1bMC05KGEtZnxBLUYpXXszfS1bMC05KGEtZnxBLUYpXXsxMn0kXCIpO1xuY29uc3QgX2NsYXNzZXMgPSB7fTtcbmNvbnN0IF9lbnYgPSB0eXBlb2YgcHJvY2VzcyA9PT0gXCJvYmplY3RcIiAmJiBwcm9jZXNzID8gKHByb2Nlc3MgPT09IG51bGwgfHwgcHJvY2VzcyA9PT0gdm9pZCAwID8gdm9pZCAwIDogcHJvY2Vzcy5lbnYpIHx8IHt9IDoge307XG5PYmplY3QuYXNzaWduKF9ydW50aW1lLCB7XG4gICAgY2xpOiBPYmplY3Qua2V5cyhfZW52KS5pbmRleE9mKFwiTk9ERVwiKSA+IC0xIHx8XG4gICAgICAgIE9iamVjdC5rZXlzKF9lbnYpLmluZGV4T2YoXCJTSEVMTFwiKSA+IC0xIHx8XG4gICAgICAgIE9iamVjdC5rZXlzKF9lbnYpLmluZGV4T2YoXCJURVJNXCIpID4gLTEgfHxcbiAgICAgICAgT2JqZWN0LmtleXMoX2VudikuaW5kZXhPZihcIlBBVEhcIikgPiAtMSxcbn0pO1xuT2JqZWN0LmFzc2lnbihfcnVudGltZSwge1xuICAgIGJyb3dzZXI6ICh0eXBlb2YgcHJvY2VzcyA9PT0gXCJvYmplY3RcIiAmJiBwcm9jZXNzICYmIChwcm9jZXNzID09PSBudWxsIHx8IHByb2Nlc3MgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHByb2Nlc3MuYnJvd3NlcikpIHx8XG4gICAgICAgICh0eXBlb2YgZG9jdW1lbnQgPT09IFwib2JqZWN0XCIgJiZcbiAgICAgICAgICAgIGRvY3VtZW50ICYmXG4gICAgICAgICAgICAoZG9jdW1lbnQgPT09IG51bGwgfHwgZG9jdW1lbnQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGRvY3VtZW50LmxvY2F0aW9uKSksXG59KTtcbk9iamVjdC5hc3NpZ24oX3J1bnRpbWUsIHtcbiAgICB4YXBwOiBfcnVudGltZS5icm93c2VyICYmICEhbmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgveHVtbVxcL3hhcHAvaSksXG59KTtcbmNvbnN0IHJ1bnRpbWUgPSBPYmplY3Qua2V5cyhfcnVudGltZSkuZmlsdGVyKChyKSA9PiBfcnVudGltZVtyXSk7XG5jb25zdCByZWFkeVByb21pc2VzID0gW107XG4vKipcbiAqIFdyYXAgYSBmdW5jdGlvbiBpbnRvIGFuIGF3YWl0ZXIsIHRpbGwgdGhlIGVudGlyZSBvYmplY3QgaXMgcmVhZHlcbiAqL1xuY29uc3QgQXN5bmNpZnkgPSAoUmV0dXJuVmFsdWUpID0+IF9fYXdhaXRlcih2b2lkIDAsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgIHlpZWxkIFByb21pc2UuYWxsKHJlYWR5UHJvbWlzZXMpO1xuICAgIHJldHVybiB5aWVsZCBSZXR1cm5WYWx1ZSgpO1xufSk7XG4vKipcbiAqIFRha2UgYW4gZW50aXJlIGNvbnN0cnVjdGVkIGNsYXNzICYgd3JhcCBhbGwgcmVzcG9uc2VzXG4gKiBpbiBhIHByb21pc2UgKEFzeW5jaWZ5KSB0aGF0IHdhaXRzIGZvciB0aGlzIGVudGlyZSBjbGFzc1xuICogdG8gYmUgcmVhZHkuXG4gKi9cbmNvbnN0IFByb3hpZnkgPSAoT2JqZWN0VG9Qcm94eSkgPT4ge1xuICAgIHJldHVybiBuZXcgUHJveHkoT2JqZWN0VG9Qcm94eSwge1xuICAgICAgICBnZXQob2JqLCBwcm9wKSB7XG4gICAgICAgICAgICBpZiAoW1wib25cIiwgXCJvZmZcIl0uaW5kZXhPZihTdHJpbmcocHJvcCkpIDwgMCAmJiAvLyBFdmVudHNcbiAgICAgICAgICAgICAgICAodHlwZW9mIG9ialtwcm9wXSA9PT0gXCJmdW5jdGlvblwiIHx8XG4gICAgICAgICAgICAgICAgICAgIG9iai5jb25zdHJ1Y3Rvci5uYW1lID09PSBcIlByb21pc2VcIikpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAob2JqLmNvbnN0cnVjdG9yLm5hbWUgPT09IFwiUHJvbWlzZVwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gb2JqLnRoZW4oKHJlcykgPT4gQXN5bmNpZnkoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXNbcHJvcF0oLi4uYXJndW1lbnRzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gQXN5bmNpZnkoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9ialtwcm9wXSguLi5hcmd1bWVudHMpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG9ialtwcm9wXTtcbiAgICAgICAgfSxcbiAgICB9KTtcbn07XG5jb25zdCBfaW5pdGlhbGl6ZWQgPSB7XG4gICAgWHVtbVNkazogZmFsc2UsXG4gICAgWHVtbVNka0p3dDogZmFsc2UsXG4gICAgWHVtbVBrY2U6IGZhbHNlLFxuICAgIHhBcHA6IGZhbHNlLFxufTtcbmxldCBfb3R0O1xubGV0IF9qd3QgPSBcIlwiO1xubGV0IF9qd3REYXRhID0ge307XG5sZXQgX21lID0ge307XG5sZXQgaW5zdGFuY2UgPSAwO1xuY2xhc3MgVW5pZmllZFVzZXJEYXRhIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5hY2NvdW50ID0gQXN5bmNpZnkoKCkgPT4geyB2YXIgX2EsIF9iLCBfYzsgcmV0dXJuIChfYiA9IChfYSA9IF9qd3REYXRhID09PSBudWxsIHx8IF9qd3REYXRhID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfand0RGF0YS5zdWIpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IF9tZSA9PT0gbnVsbCB8fCBfbWUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9tZS5zdWIpICE9PSBudWxsICYmIF9iICE9PSB2b2lkIDAgPyBfYiA6IChfYyA9IF9vdHQgPT09IG51bGwgfHwgX290dCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX290dC5hY2NvdW50X2luZm8pID09PSBudWxsIHx8IF9jID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYy5hY2NvdW50OyB9KTtcbiAgICAgICAgdGhpcy5waWN0dXJlID0gQXN5bmNpZnkoKCkgPT4ge1xuICAgICAgICAgICAgdmFyIF9hLCBfYiwgX2MsIF9kLCBfZSwgX2YsIF9nO1xuICAgICAgICAgICAgcmV0dXJuIChfYSA9IF9tZSA9PT0gbnVsbCB8fCBfbWUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9tZS5waWN0dXJlKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiAoKChfYyA9IChfYiA9IF9qd3REYXRhID09PSBudWxsIHx8IF9qd3REYXRhID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfand0RGF0YS5zdWIpICE9PSBudWxsICYmIF9iICE9PSB2b2lkIDAgPyBfYiA6IF9tZSA9PT0gbnVsbCB8fCBfbWUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9tZS5zdWIpICE9PSBudWxsICYmIF9jICE9PSB2b2lkIDAgPyBfYyA6IChfZCA9IF9vdHQgPT09IG51bGwgfHwgX290dCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX290dC5hY2NvdW50X2luZm8pID09PSBudWxsIHx8IF9kID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfZC5hY2NvdW50KVxuICAgICAgICAgICAgICAgID8gYGh0dHBzOi8veHVtbS5hcHAvYXZhdGFyLyR7KF9mID0gKF9lID0gX2p3dERhdGEgPT09IG51bGwgfHwgX2p3dERhdGEgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9qd3REYXRhLnN1YikgIT09IG51bGwgJiYgX2UgIT09IHZvaWQgMCA/IF9lIDogX21lID09PSBudWxsIHx8IF9tZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX21lLnN1YikgIT09IG51bGwgJiYgX2YgIT09IHZvaWQgMCA/IF9mIDogKF9nID0gX290dCA9PT0gbnVsbCB8fCBfb3R0ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfb3R0LmFjY291bnRfaW5mbykgPT09IG51bGwgfHwgX2cgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9nLmFjY291bnR9LnBuZ2BcbiAgICAgICAgICAgICAgICA6IHVuZGVmaW5lZCk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLm5hbWUgPSBBc3luY2lmeSgoKSA9PiB7IHZhciBfYSwgX2I7IHJldHVybiAoX2EgPSBfbWUgPT09IG51bGwgfHwgX21lID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfbWUubmFtZSkgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogKF9iID0gX290dCA9PT0gbnVsbCB8fCBfb3R0ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfb3R0LmFjY291bnRfaW5mbykgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLm5hbWU7IH0pO1xuICAgICAgICB0aGlzLmRvbWFpbiA9IEFzeW5jaWZ5KCgpID0+IHsgdmFyIF9hLCBfYjsgcmV0dXJuIChfYSA9IF9tZSA9PT0gbnVsbCB8fCBfbWUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9tZS5kb21haW4pICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IChfYiA9IF9vdHQgPT09IG51bGwgfHwgX290dCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX290dC5hY2NvdW50X2luZm8pID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5kb21haW47IH0pO1xuICAgICAgICB0aGlzLnNvdXJjZSA9IEFzeW5jaWZ5KCgpID0+IHsgdmFyIF9hLCBfYjsgcmV0dXJuIChfYSA9IF9tZSA9PT0gbnVsbCB8fCBfbWUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9tZS5zb3VyY2UpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IChfYiA9IF9vdHQgPT09IG51bGwgfHwgX290dCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX290dC5hY2NvdW50X2luZm8pID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5zb3VyY2U7IH0pO1xuICAgICAgICB0aGlzLm5ldHdvcmtUeXBlID0gQXN5bmNpZnkoKCkgPT4ge1xuICAgICAgICAgICAgdmFyIF9hLCBfYjtcbiAgICAgICAgICAgIHJldHVybiAoX2IgPSAoX2EgPSBfbWUgPT09IG51bGwgfHwgX21lID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfbWUubmV0d29ya1R5cGUpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IF9qd3REYXRhLm5ldHdvcmtfdHlwZSkgIT09IG51bGwgJiYgX2IgIT09IHZvaWQgMCA/IF9iIDogX290dCA9PT0gbnVsbCB8fCBfb3R0ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfb3R0Lm5vZGV0eXBlO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5uZXR3b3JrRW5kcG9pbnQgPSBBc3luY2lmeSgoKSA9PiB7XG4gICAgICAgICAgICB2YXIgX2EsIF9iO1xuICAgICAgICAgICAgcmV0dXJuIChfYiA9IChfYSA9IF9tZSA9PT0gbnVsbCB8fCBfbWUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9tZS5uZXR3b3JrRW5kcG9pbnQpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IF9qd3REYXRhLm5ldHdvcmtfbmRwb2ludCkgIT09IG51bGwgJiYgX2IgIT09IHZvaWQgMCA/IF9iIDogX290dCA9PT0gbnVsbCB8fCBfb3R0ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfb3R0Lm5vZGV3c3M7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmJsb2NrZWQgPSBBc3luY2lmeSgoKSA9PiB7IHZhciBfYSwgX2I7IHJldHVybiAoX2EgPSBfbWUgPT09IG51bGwgfHwgX21lID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfbWUuYmxvY2tlZCkgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogKF9iID0gX290dCA9PT0gbnVsbCB8fCBfb3R0ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfb3R0LmFjY291bnRfaW5mbykgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLmJsb2NrZWQ7IH0pO1xuICAgICAgICB0aGlzLmt5Y0FwcHJvdmVkID0gQXN5bmNpZnkoKCkgPT4geyB2YXIgX2EsIF9iOyByZXR1cm4gKF9hID0gX21lID09PSBudWxsIHx8IF9tZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX21lLmt5Y0FwcHJvdmVkKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiAoX2IgPSBfb3R0ID09PSBudWxsIHx8IF9vdHQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9vdHQuYWNjb3VudF9pbmZvKSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Iua3ljQXBwcm92ZWQ7IH0pO1xuICAgICAgICB0aGlzLnByb1N1YnNjcmlwdGlvbiA9IEFzeW5jaWZ5KCgpID0+IHsgdmFyIF9hLCBfYjsgcmV0dXJuIChfYSA9IF9tZSA9PT0gbnVsbCB8fCBfbWUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9tZS5wcm9TdWJzY3JpcHRpb24pICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IChfYiA9IF9vdHQgPT09IG51bGwgfHwgX290dCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX290dC5hY2NvdW50X2luZm8pID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5wcm9TdWJzY3JpcHRpb247IH0pO1xuICAgIH1cbn1cbi8qKlxuICogVGhpcyBpcyB3aGVyZSB0aGUgbWFnaWMgaGFwcGVuc1xuICovXG5jbGFzcyBYdW1tIGV4dGVuZHMgZXZlbnRzXzEuRXZlbnRFbWl0dGVyIHtcbiAgICBjb25zdHJ1Y3RvcihhcGlLZXlPckp3dCwgYXBpU2VjcmV0T3JPdHQpIHtcbiAgICAgICAgdmFyIF9hLCBfYiwgX2MsIF9kO1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLmluc3RhbmNlID0gXCIwXCI7XG4gICAgICAgIHRoaXMuand0Q3JlZGVudGlhbCA9IGZhbHNlO1xuICAgICAgICB0aGlzLnJ1bnRpbWUgPSBfcnVudGltZTtcbiAgICAgICAgaW5zdGFuY2UrKztcbiAgICAgICAgdGhpcy5pbnN0YW5jZSA9IFN0cmluZyhpbnN0YW5jZSk7XG4gICAgICAgIGlmICh0eXBlb2YgKGNvbnNvbGUgPT09IG51bGwgfHwgY29uc29sZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogY29uc29sZS5sb2cpICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIkNvbnN0cnVjdGVkIFh1bW1cIiwgeyBydW50aW1lIH0pO1xuICAgICAgICB9XG4gICAgICAgIGxldCBqd3RFeHBpcmVkID0gZmFsc2U7XG4gICAgICAgIGlmICh0eXBlb2YgYXBpS2V5T3JKd3QgPT09IFwic3RyaW5nXCIgJiZcbiAgICAgICAgICAgIGFwaUtleU9ySnd0LnNwbGl0KFwiLlwiKS5sZW5ndGggPT09IDMpIHtcbiAgICAgICAgICAgIGxldCBfdGVzdEp3dERhdGE7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIC8vIENoZWNrIHZhbGlkaXR5XG4gICAgICAgICAgICAgICAgX3Rlc3RKd3REYXRhID0gSlNPTi5wYXJzZShhdG9iKChfYSA9IGFwaUtleU9ySnd0LnNwbGl0KFwiLlwiKSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hWzFdKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIC8vIGVcbiAgICAgICAgICAgICAgICAvLyBQYXJzZSBlcnJvclxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKERhdGUubm93KCkgPj0gX3Rlc3RKd3REYXRhLmV4cCAqIDEwMDApIHtcbiAgICAgICAgICAgICAgICBqd3RFeHBpcmVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBjb25zdCBhcHBJZCA9IChfZCA9IChfYyA9IChfYiA9IF90ZXN0Snd0RGF0YSA9PT0gbnVsbCB8fCBfdGVzdEp3dERhdGEgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90ZXN0Snd0RGF0YS5hcHBfdXVpZHY0KSAhPT0gbnVsbCAmJiBfYiAhPT0gdm9pZCAwID8gX2IgOiBfdGVzdEp3dERhdGEgPT09IG51bGwgfHwgX3Rlc3RKd3REYXRhID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGVzdEp3dERhdGEuY2xpZW50X2lkKSAhPT0gbnVsbCAmJiBfYyAhPT0gdm9pZCAwID8gX2MgOiBfdGVzdEp3dERhdGEgPT09IG51bGwgfHwgX3Rlc3RKd3REYXRhID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGVzdEp3dERhdGEuYXVkKSAhPT0gbnVsbCAmJiBfZCAhPT0gdm9pZCAwID8gX2QgOiAnJztcbiAgICAgICAgICAgICAgICBhcGlLZXlPckp3dCA9IGFwcElkO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdKV1QgZXhwaXJlZCwgZmFsbGluZyBiYWNrIHRvIEFQSSBLRVk6ICcgKyBhcHBJZCk7XG4gICAgICAgICAgICAgICAgaWYgKF9ydW50aW1lLmNsaSB8fCBfcnVudGltZS54YXBwKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKCdKV1QgRXhwaXJlZCwgY2Fubm90IGZhbGwgYmFjayB0byBBUEkgY3JlZGVudGlhbDogaW4gQ0xJL3hBcHAgZW52aXJvbm1lbnQnKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbWl0KCdlcnJvcicsIGVycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFqd3RFeHBpcmVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5qd3RDcmVkZW50aWFsID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBfand0ID0gYXBpS2V5T3JKd3Q7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEhhbmRsZXJzIChzZXR1cClcbiAgICAgICAgICovXG4gICAgICAgIGNvbnN0IGhhbmRsZVhhcHBFdmVudHMgPSAoKSA9PiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICAvLyBBbHdheXMgYXR0YWNoIGV2ZW50IGxpc3RlbmVyc1xuICAgICAgICAgICAgLy8gU28gbm86ICAmJiAhX2luaXRpYWxpemVkLnhBcHBcbiAgICAgICAgICAgIGlmIChfY2xhc3NlcyA9PT0gbnVsbCB8fCBfY2xhc3NlcyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2NsYXNzZXMueEFwcCkge1xuICAgICAgICAgICAgICAgIF9pbml0aWFsaXplZC54QXBwID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBfY2xhc3Nlcy54QXBwLm9uKFwicXJcIiwgKGRhdGEpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbWl0KFwicXJcIiwgZGF0YSwgdGhpcy5pbnN0YW5jZSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgX2NsYXNzZXMueEFwcC5vbihcInBheWxvYWRcIiwgKGRhdGEpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbWl0KFwicGF5bG9hZFwiLCBkYXRhLCB0aGlzLmluc3RhbmNlKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBfY2xhc3Nlcy54QXBwLm9uKFwiZGVzdGluYXRpb25cIiwgKGRhdGEpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbWl0KFwiZGVzdGluYXRpb25cIiwgZGF0YSwgdGhpcy5pbnN0YW5jZSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBoYW5kbGVQa2NlRXZlbnRzID0gKCkgPT4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgLy8gQWx3YXlzIGF0dGFjaCBldmVudCBsaXN0ZW5lcnNcbiAgICAgICAgICAgIC8vIFNvIG5vOiAgJiYgIV9pbml0aWFsaXplZC5YdW1tUGtjZVxuICAgICAgICAgICAgaWYgKF9jbGFzc2VzID09PSBudWxsIHx8IF9jbGFzc2VzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfY2xhc3Nlcy5YdW1tUGtjZSkge1xuICAgICAgICAgICAgICAgIF9pbml0aWFsaXplZC5YdW1tUGtjZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgX2NsYXNzZXMuWHVtbVBrY2Uub24oXCJyZXRyaWV2ZWRcIiwgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmVtaXQoXCJyZXRyaWV2ZWRcIik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgX2NsYXNzZXMuWHVtbVBrY2Uub24oXCJzdWNjZXNzXCIsICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbWl0KFwic3VjY2Vzc1wiKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBfY2xhc3Nlcy5YdW1tUGtjZS5vbihcImVycm9yXCIsIChkYXRhKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZW1pdChcImVycm9yXCIsIGRhdGEpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFh1bW0gU0RLXG4gICAgICAgICAqL1xuICAgICAgICBjb25zdCBoYW5kbGVPdHRKd3QgPSAoKSA9PiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICB2YXIgX2U7XG4gICAgICAgICAgICBpZiAoKF9jbGFzc2VzID09PSBudWxsIHx8IF9jbGFzc2VzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfY2xhc3Nlcy5YdW1tU2RrSnd0KSAmJiAhX2luaXRpYWxpemVkLlh1bW1TZGtKd3QpIHtcbiAgICAgICAgICAgICAgICBfaW5pdGlhbGl6ZWQuWHVtbVNka0p3dCA9IHRydWU7XG4gICAgICAgICAgICAgICAgY29uc3QgZG9Ob3RGZXRjaEp3dE90dCA9IHRoaXMuand0Q3JlZGVudGlhbCB8fCBfand0ICE9PSBcIlwiO1xuICAgICAgICAgICAgICAgIGlmICghZG9Ob3RGZXRjaEp3dE90dCkge1xuICAgICAgICAgICAgICAgICAgICByZWFkeVByb21pc2VzLnB1c2goX2NsYXNzZXMuWHVtbVNka0p3dC5nZXRPdHREYXRhKCkpO1xuICAgICAgICAgICAgICAgICAgICByZWFkeVByb21pc2VzLnB1c2goX2NsYXNzZXMuWHVtbVNka0p3dC5nZXRKd3QoKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnN0IG90dCA9ICFkb05vdEZldGNoSnd0T3R0XG4gICAgICAgICAgICAgICAgICAgID8geWllbGQgX2NsYXNzZXMuWHVtbVNka0p3dC5nZXRPdHREYXRhKClcbiAgICAgICAgICAgICAgICAgICAgOiBudWxsO1xuICAgICAgICAgICAgICAgIGNvbnN0IGp3dCA9ICFkb05vdEZldGNoSnd0T3R0XG4gICAgICAgICAgICAgICAgICAgID8geWllbGQgX2NsYXNzZXMuWHVtbVNka0p3dC5nZXRKd3QoKVxuICAgICAgICAgICAgICAgICAgICA6IF9qd3Q7XG4gICAgICAgICAgICAgICAgaWYgKG90dCkge1xuICAgICAgICAgICAgICAgICAgICBfb3R0ID0gb3R0O1xuICAgICAgICAgICAgICAgICAgICAvLyBUT0RPOiBESVNBQkxFXG4gICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKFwieGFwcCBvdHRkYXRhXCIsIF9vdHQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoand0KSB7XG4gICAgICAgICAgICAgICAgICAgIF9qd3QgPSBqd3Q7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfand0RGF0YSA9IEpTT04ucGFyc2UoYXRvYigoX2UgPSBfand0LnNwbGl0KFwiLlwiKSkgPT09IG51bGwgfHwgX2UgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9lWzFdKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhcInBrY2UveGFwcCBqd3RkYXRhXCIsIF9qd3REYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiAoY29uc29sZSA9PT0gbnVsbCB8fCBjb25zb2xlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBjb25zb2xlLmxvZykgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkVycm9yIGRlY29kaW5nIEpXVFwiLCAoZSA9PT0gbnVsbCB8fCBlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBlLm1lc3NhZ2UpIHx8IFwiXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgKGNvbnNvbGUgPT09IG51bGwgfHwgY29uc29sZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogY29uc29sZS5sb2cpICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHsgb3R0LCBqd3QgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgaW5pdE90dEp3dFJ1bnRpbWUgPSAoKSA9PiB7XG4gICAgICAgICAgICBpZiAoIShfY2xhc3NlcyA9PT0gbnVsbCB8fCBfY2xhc3NlcyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2NsYXNzZXMuWHVtbVNka0p3dCkpIHtcbiAgICAgICAgICAgICAgICBPYmplY3QuYXNzaWduKF9jbGFzc2VzLCB7XG4gICAgICAgICAgICAgICAgICAgIFh1bW1TZGtKd3Q6IG5ldyAocmVxdWlyZShcInh1bW0tc2RrXCIpLlh1bW1TZGtKd3QpKGFwaUtleU9ySnd0KSxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZWFkeVByb21pc2VzLnB1c2goaGFuZGxlT3R0Snd0KCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBpZiAoX3J1bnRpbWUueGFwcCkge1xuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiB4QXBwXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGlmICh0eXBlb2YgYXBpS2V5T3JKd3QgIT09IFwic3RyaW5nXCIgfHxcbiAgICAgICAgICAgICAgICAhKHV1aWR2NHJlLnRlc3QoYXBpS2V5T3JKd3QpIHx8IHRoaXMuand0Q3JlZGVudGlhbCkpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJSdW5uaW5nIGluIHhBcHAsIGNvbnN0cnVjdG9yIHJlcXVpcmVzIGZpcnN0IHBhcmFtLiB0byBiZSBYdW1tIEFQSSBLZXkgb3IgSldUXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCEoX2NsYXNzZXMgPT09IG51bGwgfHwgX2NsYXNzZXMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9jbGFzc2VzLnhBcHApKSB7XG4gICAgICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihfY2xhc3Nlcywge1xuICAgICAgICAgICAgICAgICAgICB4QXBwOiBuZXcgKHJlcXVpcmUoXCJ4dW1tLXhhcHAtc2RrXCIpLnhBcHApKCksXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZWFkeVByb21pc2VzLnB1c2goaGFuZGxlWGFwcEV2ZW50cygpKTtcbiAgICAgICAgICAgIGluaXRPdHRKd3RSdW50aW1lKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoX3J1bnRpbWUuYnJvd3Nlcikge1xuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBCcm93c2VyIChKV1QsIFBLQ0U/KVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBpZiAodHlwZW9mIGFwaUtleU9ySnd0ICE9PSBcInN0cmluZ1wiIHx8XG4gICAgICAgICAgICAgICAgISh1dWlkdjRyZS50ZXN0KGFwaUtleU9ySnd0KSB8fCB0aGlzLmp3dENyZWRlbnRpYWwpKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiUnVubmluZyBpbiBicm93c2VyLCBjb25zdHJ1Y3RvciByZXF1aXJlcyBmaXJzdCBwYXJhbS4gdG8gYmUgWHVtbSBBUEkgS2V5IG9yIEpXVFwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghKF9jbGFzc2VzID09PSBudWxsIHx8IF9jbGFzc2VzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfY2xhc3Nlcy5YdW1tUGtjZSkpIHtcbiAgICAgICAgICAgICAgICBPYmplY3QuYXNzaWduKF9jbGFzc2VzLCB7XG4gICAgICAgICAgICAgICAgICAgIFh1bW1Qa2NlOiBuZXcgeHVtbV9vYXV0aDJfcGtjZV8xLlh1bW1Qa2NlKGFwaUtleU9ySnd0LCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpbXBsaWNpdDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgaWYgKF9jbGFzc2VzLlh1bW1Qa2NlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmp3dENyZWRlbnRpYWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGluaXRPdHRKd3RSdW50aW1lKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZXRJbW1lZGlhdGUoKCkgPT4gdGhpcy5lbWl0KCdyZXRyaWV2aW5nJykpO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaGFuZGxlUGtjZVN0YXRlID0gKHJlc29sdmUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgX2EsIF9iO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIChfYiA9IChfYSA9IF9jbGFzc2VzLlh1bW1Qa2NlKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Euc3RhdGUoKSkgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLnRoZW4oKHN0YXRlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHN0YXRlOiBqd3QsIG1lLCBzZGtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKChzdGF0ZSA9PT0gbnVsbCB8fCBzdGF0ZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogc3RhdGUuc2RrKSAmJiAhKF9jbGFzc2VzID09PSBudWxsIHx8IF9jbGFzc2VzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfY2xhc3Nlcy5YdW1tU2RrSnd0KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihfY2xhc3NlcywgeyBYdW1tU2RrSnd0OiBzdGF0ZS5zZGsgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBPYmplY3QuYXNzaWduKF9tZSwgT2JqZWN0LmFzc2lnbih7fSwgKChzdGF0ZSA9PT0gbnVsbCB8fCBzdGF0ZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogc3RhdGUubWUpIHx8IHt9KSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoc3RhdGUgPT09IG51bGwgfHwgc3RhdGUgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHN0YXRlLmp3dCkgJiYgX2p3dCA9PT0gXCJcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2p3dCA9IHN0YXRlLmp3dDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZU90dEp3dCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc3RhdGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlYWR5UHJvbWlzZXMucHVzaChoYW5kbGVQa2NlRXZlbnRzKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVhZHlQcm9taXNlcy5wdXNoKG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9hLCBfYjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoX2EgPSBfY2xhc3Nlcy5YdW1tUGtjZSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLm9uKFwicmV0cmlldmVkXCIsICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlUGtjZVN0YXRlKHJlc29sdmUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIChfYiA9IF9jbGFzc2VzLlh1bW1Qa2NlKSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Iub24oXCJzdWNjZXNzXCIsICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFuZGxlUGtjZVN0YXRlKHJlc29sdmUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKF9ydW50aW1lLmNsaSkge1xuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBDTEksIE5vZGUgLyAuLi5cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBhcGlLZXlPckp3dCAhPT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlJ1bm5pbmcgQ0xJLCBjb25zdHJ1Y3RvciBuZWVkcyBmaXJzdCBwYXJhbS4gdG8gYmUgWHVtbSBBUEkgS2V5IC8gcmF3IEpXVFwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmICh1dWlkdjRyZS50ZXN0KGFwaUtleU9ySnd0KSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBBUEkgS2V5XG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgYXBpU2VjcmV0T3JPdHQgIT09IFwic3RyaW5nXCIgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICF1dWlkdjRyZS50ZXN0KGFwaVNlY3JldE9yT3R0KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiUnVubmluZyBDTEksIGNvbnN0cnVjdG9yIGZpcnN0IHBhcmFtLiBpcyBBUEkgS2V5LCBidXQgc2Vjb25kIHBhcmFtLiBpc24ndCBhIHZhbGlkIEFQSSBTZWNyZXRcIik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKCF1dWlkdjRyZS50ZXN0KGFwaUtleU9ySnd0KSAmJlxuICAgICAgICAgICAgICAgICAgICBhcGlLZXlPckp3dC5zcGxpdChcIi5cIikubGVuZ3RoICE9PSAzKSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlJ1bm5pbmcgQ0xJLCBjb25zdHJ1Y3RvciBmaXJzdCBwYXJhbS4gbm90IGEgdmFsaWQgSldULCBub3IgYSB2YWxpZCBBUEkgS2V5XCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBBbGwgZmluZVxuICAgICAgICAgICAgICAgIGlmICghKF9jbGFzc2VzID09PSBudWxsIHx8IF9jbGFzc2VzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfY2xhc3Nlcy5YdW1tU2RrKSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5qd3RDcmVkZW50aWFsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpbml0T3R0Snd0UnVudGltZSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihfY2xhc3Nlcywge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFh1bW1TZGs6IG5ldyAocmVxdWlyZShcInh1bW0tc2RrXCIpLlh1bW1TZGspKGFwaUtleU9ySnd0LCBhcGlTZWNyZXRPck90dCksXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvKipcbiAgICAgICAgICogQm9vdHN0cmFwIGNsYXNzIHByb3BlcnRpZXNcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMudXNlciA9IG5ldyBVbmlmaWVkVXNlckRhdGEoKTtcbiAgICAgICAgdGhpcy5lbnZpcm9ubWVudCA9IHtcbiAgICAgICAgICAgIGp3dDogQXN5bmNpZnkoKCkgPT4gX2p3dERhdGEpLFxuICAgICAgICAgICAgb3R0OiBBc3luY2lmeSgoKSA9PiBfb3R0KSxcbiAgICAgICAgICAgIG9wZW5pZDogQXN5bmNpZnkoKCkgPT4gX21lKSxcbiAgICAgICAgICAgIGJlYXJlcjogQXN5bmNpZnkoKCkgPT4gX2p3dCksXG4gICAgICAgICAgICByZXRyaWV2aW5nOiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHRoaXMub24oJ3JldHJpZXZpbmcnLCAoKSA9PiByZXNvbHZlKCkpKSxcbiAgICAgICAgICAgIHJlYWR5OiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHRoaXMub24oJ3JlYWR5JywgKCkgPT4gcmVzb2x2ZSgpKSksXG4gICAgICAgIH07XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBYdW1tIFNESyBtYXBwZWRcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuaGVscGVycyA9IFByb3hpZnkoQXN5bmNpZnkoKCkgPT4gKF9jbGFzc2VzLlh1bW1TZGsgfHwgX2NsYXNzZXMuWHVtbVNka0p3dCkpKTtcbiAgICAgICAgdGhpcy5wdXNoID0gUHJveGlmeShBc3luY2lmeSgoKSA9PiAoX2NsYXNzZXMuWHVtbVNkayB8fCBfY2xhc3Nlcy5YdW1tU2RrSnd0KVxuICAgICAgICAgICAgLlB1c2gpKTtcbiAgICAgICAgdGhpcy5wYXlsb2FkID0gUHJveGlmeShBc3luY2lmeSgoKSA9PiAoX2NsYXNzZXMuWHVtbVNkayB8fCBfY2xhc3Nlcy5YdW1tU2RrSnd0KVxuICAgICAgICAgICAgLnBheWxvYWQpKTtcbiAgICAgICAgdGhpcy51c2Vyc3RvcmUgPSBQcm94aWZ5KEFzeW5jaWZ5KCgpID0+IChfY2xhc3Nlcy5YdW1tU2RrIHx8IF9jbGFzc2VzLlh1bW1TZGtKd3QpXG4gICAgICAgICAgICAuand0VXNlcmRhdGEpKTtcbiAgICAgICAgdGhpcy5iYWNrZW5kc3RvcmUgPSBQcm94aWZ5KEFzeW5jaWZ5KCgpID0+IChfY2xhc3Nlcy5YdW1tU2RrIHx8IF9jbGFzc2VzLlh1bW1TZGtKd3QpXG4gICAgICAgICAgICAuc3RvcmFnZSkpO1xuICAgICAgICAvKipcbiAgICAgICAgICogWHVtbSB4QXBwIFNESzogVUkgbGliLlxuICAgICAgICAgKi9cbiAgICAgICAgY29uc3QgeGFwcCA9IF9jbGFzc2VzID09PSBudWxsIHx8IF9jbGFzc2VzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfY2xhc3Nlcy54QXBwO1xuICAgICAgICBpZiAoeGFwcClcbiAgICAgICAgICAgIHRoaXMueGFwcCA9IHhhcHA7XG4gICAgICAgIHNldEltbWVkaWF0ZSgoKSA9PiB7XG4gICAgICAgICAgICBQcm9taXNlLmFsbChyZWFkeVByb21pc2VzKS50aGVuKCgpID0+IHRoaXMuZW1pdCgncmVhZHknKSk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBQS0NFXG4gICAgICovXG4gICAgYXV0aG9yaXplKCkge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhcIkF1dGhvcml6ZVwiKTtcbiAgICAgICAgICAgIHJldHVybiAoX2EgPSBfY2xhc3NlcyA9PT0gbnVsbCB8fCBfY2xhc3NlcyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2NsYXNzZXMuWHVtbVBrY2UpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5hdXRob3JpemUoKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGxvZ291dCgpIHtcbiAgICAgICAgdmFyIF9hO1xuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihfY2xhc3NlcywgeyBYdW1tU2RrSnd0OiB1bmRlZmluZWQgfSk7XG4gICAgICAgICAgICB0aGlzLmVtaXQoXCJsb2dvdXRcIik7XG4gICAgICAgICAgICByZXR1cm4gKF9hID0gX2NsYXNzZXMgPT09IG51bGwgfHwgX2NsYXNzZXMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9jbGFzc2VzLlh1bW1Qa2NlKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EubG9nb3V0KCk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTREtcbiAgICAgKi9cbiAgICBwaW5nKCkge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XG4gICAgICAgICAgICAvLyBUT0RPOiBXaGF0IGlmIG5vdCBKV1QgYnV0IHJlZ3VsYXI/XG4gICAgICAgICAgICB5aWVsZCBQcm9taXNlLmFsbChyZWFkeVByb21pc2VzKTtcbiAgICAgICAgICAgIHJldHVybiAoX2EgPSAoKF9jbGFzc2VzID09PSBudWxsIHx8IF9jbGFzc2VzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfY2xhc3Nlcy5YdW1tU2RrSnd0KSB8fCAoX2NsYXNzZXMgPT09IG51bGwgfHwgX2NsYXNzZXMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9jbGFzc2VzLlh1bW1TZGspKSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnBpbmcoKTtcbiAgICAgICAgfSk7XG4gICAgfVxufVxuZXhwb3J0cy5YdW1tID0gWHVtbTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/xumm/dist/index.js\n");

/***/ })

};
;